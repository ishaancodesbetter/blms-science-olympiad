<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Attendance Report ‚Äî BLMS Science Olympiad</title>

<style>
/* === COLOR THEMES === */
:root {
  --bg: radial-gradient(1000px 800px at 10% -10%, #0b1124, transparent 70%),
        radial-gradient(1200px 900px at 120% 130%, #1b1f3a, transparent 70%),
        linear-gradient(160deg, #0d1224 0%, #151b2f 100%);
  --card: rgba(255,255,255,0.08);
  --text: #e8ecff;
  --accent: #00d4ff;
  --shadow: rgba(0,0,0,0.6);
  --present: #35ff88;
  --absent: #ff5570;
  --excused: #ffd95a;
}

[data-theme="light"] {
  --bg: radial-gradient(1000px 800px at 10% -10%, #f0f4ff, transparent 70%),
        radial-gradient(1200px 900px at 120% 130%, #f7e7ff, transparent 70%),
        linear-gradient(160deg, #fefeff 0%, #f6f8ff 100%);
  --card: rgba(255,255,255,0.55);
  --text: #1b1d2e;
  --accent: #007aff;
  --shadow: rgba(0,0,0,0.1);
}

/* === GLOBAL === */
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:"SF Pro Display","Segoe UI",Roboto,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  transition:background .6s ease,color .6s ease;
}

/* === NAV === */
.nav{
  position:fixed;top:20px;left:50%;transform:translateX(-50%);
  z-index:10;display:flex;gap:20px;
  background:rgba(255,255,255,0.07);
  border:1px solid rgba(255,255,255,0.2);
  border-radius:50px;
  padding:10px 25px;
  backdrop-filter:blur(20px);
}
.nav a{color:var(--text);text-decoration:none;font-weight:600;font-size:.95rem}
.nav a:hover{color:var(--accent)}

/* === THEME TOGGLE === */
.toggle{
  position:fixed;top:20px;right:20px;
  background:rgba(255,255,255,0.1);
  border:1px solid rgba(255,255,255,0.3);
  border-radius:50px;
  padding:8px 16px;
  backdrop-filter:blur(20px);
  cursor:pointer;
  font-weight:600;
  color:var(--text);
  transition:0.3s;
}
.toggle:hover{background:rgba(255,255,255,0.25)}

/* === HEADER === */
header{text-align:center;padding:80px 20px 40px}
h1{
  font-size:3rem;font-weight:900;
  background:linear-gradient(90deg,#00d4ff,#6c63ff);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  text-shadow:0 0 20px rgba(108,99,255,0.4);
}
.tagline{margin-top:10px;font-size:1.2rem;opacity:.8}

/* === TABLE WRAPPER === */
.table-wrapper{
  width:90%;max-width:1200px;
  border-radius:20px;
  background:var(--card);
  backdrop-filter:blur(25px) saturate(180%);
  box-shadow:0 8px 40px var(--shadow);
  padding:20px;overflow-x:auto;
}

/* === TABLE === */
table{width:100%;border-collapse:collapse;min-width:900px;}
th{
  text-align:center;font-size:1rem;font-weight:700;
  color:var(--accent);
  padding:14px 10px;
  border-bottom:1px solid rgba(255,255,255,0.2);
}
td{
  text-align:center;padding:12px 10px;font-size:1rem;
  border-bottom:1px solid rgba(255,255,255,0.08);
  transition:background .3s ease;
}
td:first-child{text-align:left;font-weight:600;color:var(--text)}

/* === STATUS COLORS === */
.present{color:var(--present);font-weight:700;text-shadow:0 0 8px rgba(53,255,136,.4)}
.absent{color:var(--absent);font-weight:700;text-shadow:0 0 8px rgba(255,85,112,.4)}
.excused{color:var(--excused);font-weight:700;text-shadow:0 0 8px rgba(255,217,90,.4)}

tr:hover td{background:rgba(255,255,255,0.05)}

footer{margin:60px 0 30px;font-size:.9rem;opacity:.7;text-align:center}
</style>
</head>
<body data-theme="dark">

<nav class="nav">
  <a href="index.html">üè† Home</a>
  <a href="roster.html">üë• Roster</a>
  <a href="tournaments.html">üèÜ Tournaments</a>
  <a href="attendance.html">üóìÔ∏è Attendance</a>
</nav>

<button class="toggle" id="modeToggle">üåô Dark</button>

<header>
  <h1>Attendance Report</h1>
  <p class="tagline">P = Present | A = Absent | E = Excused</p>
</header>

<div class="table-wrapper">
  <table id="attendanceTable">
    <thead>
      <tr id="tableHead"><th>Student</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<footer>¬© <span id="year"></span> BLMS Science Olympiad ‚Äî Division B</footer>

<script>
document.getElementById("year").textContent = new Date().getFullYear();

// === LIGHT/DARK TOGGLE ===
const btn=document.getElementById("modeToggle");
btn.addEventListener("click",()=>{
  const html=document.documentElement;
  const isDark=html.dataset.theme==="dark";
  html.dataset.theme=isDark?"light":"dark";
  btn.textContent=isDark?"‚òÄÔ∏è Light":"üåô Dark";
});

// === GOOGLE SHEET SOURCE ===
// Replace this link with your published CSV link from Sheets
const sheetUrl="https://docs.google.com/spreadsheets/d/e/YOUR_SHEET_ID/pub?output=csv";

// === FETCH AND BUILD TABLE ===
fetch(sheetUrl)
.then(res=>res.text())
.then(csv=>{
  const rows=csv.trim().split("\n").map(r=>r.split(","));
  const headerRow=rows[0];
  const tableHead=document.getElementById("tableHead");
  headerRow.slice(1).forEach(date=>{
    const th=document.createElement("th");
    th.textContent=date;
    tableHead.appendChild(th);
  });
  const body=document.querySelector("tbody");
  rows.slice(1).forEach(r=>{
    const name=r[0];
    const row=document.createElement("tr");
    row.innerHTML=`<td>${name}</td>`+r.slice(1).map(v=>{
      const val=v.trim().toUpperCase();
      let cls="";
      if(val==="P")cls="present";
      else if(val==="A")cls="absent";
      else if(val==="E")cls="excused";
      return `<td class="${cls}">${val}</td>`;
    }).join("");
    body.appendChild(row);
  });
})
.catch(err=>{
  console.error(err);
  document.querySelector("tbody").innerHTML=
    `<tr><td colspan="6">‚ö†Ô∏è Unable to load Google Sheet data</td></tr>`;
});
</script>
</body>
</html>


